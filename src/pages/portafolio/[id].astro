---
import Layout from '../../layouts/Layout.astro';
import { db } from '../../lib/firebase';
import { doc, getDoc, collection, getDocs } from 'firebase/firestore';

export async function getStaticPaths() {
  const projectsCol = collection(db, 'projects');
  const projectsSnapshot = await getDocs(projectsCol);
  
  const paths = projectsSnapshot.docs.map(docSnap => {
    return {
      params: { id: docSnap.id },
      props: { project: docSnap.data() },
    };
  });
  
  return paths;
}

const { project } = Astro.props;
---

<Layout title={project.title}>
  <div class="container mx-auto mt-10 px-4 max-w-4xl">
    
    <div class="text-center mb-8">
      <span class="text-blue-400 font-semibold">{project.category_name}</span>
      <h1 class="text-4xl md:text-5xl font-bold mt-2">{project.title}</h1>
    </div>

    <div class="mb-8">
      <img src={project.cover_image_url || 'https://via.placeholder.com/800x450.png?text=Freddy+VÃ¡squez'} alt={`Imagen de ${project.title}`} class="w-full rounded-lg shadow-lg">
    </div>

    <div class="prose prose-invert max-w-none text-lg" set:html={project.description?.replace(/\n/g, '<br/>')} />

    <div class="text-center mt-12">
      <a href="/portafolio" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition-colors">
        &larr; Volver al Portafolio
      </a>
    </div>
  </div>
</Layout>